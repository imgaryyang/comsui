webpackJsonp([10,23],{5:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(31),a=i(1),o=function(t,e){var i={};return Object.keys(e).forEach(function(n){if(t.hasOwnProperty(n)){var a=e[n];if("string"==typeof a&&""!==a)try{/^\[[\s\S]*\]$/.test(a)&&(a=JSON.parse(a))}catch(t){}i[n]=a}}),i};e.default={data:function(){return{listenConditionChange:!1}},computed:{conditions:function(){var t=(0,a.filterQueryConds)(this.queryConds);return Object.assign({},t,this.comboConds,this.sortConds,this.pageConds)},filterConds:function(){return Object.assign({},this.queryConds,this.comboConds)}},watch:{initializing:function(t){t?this.initializeLoading=this.$loading({text:"正在初始化",target:this.$el}):this.initializeLoading&&this.initializeLoading.close()}},activated:function(){this.disableGlobalQueryCache=!0,this.setRouteQueryListener(),this.initializing||this.setChangeListener(),this.initializing||this.equalTo((0,a.purify)(this.lastRouteQuery),(0,a.purify)(this.$route.query))||(this.disableGlobalQueryCache?this.extractFromQuery(this.mergeDefaultQuery(this.$route.query)):this.extractFromQuery(this.mergeDefaultQuery(this.$store.state.query,this.$route.query)),this.dataSource.list=[],this.dataSource.size=0,this.dataSource.error="",this.dataSource.fetching=!1,(this.autoload!==!1||this.existRouteQueryExceptTimestamp())&&this.fetch())},deactivated:function(){this.unsetRouteQueryListener(),this.unsetChangeListener()},beforeRouteLeave:function(t,e,i){this.disableGlobalQueryCache||this.$store.commit(n.SET_CACHE_QUERY,JSON.parse(JSON.stringify(this.conditions))),this.lastRouteQuery=this.$route.query,i()},methods:{unsetRouteQueryListener:function(){"function"==typeof this.unwatchRouteQuery&&this.unwatchRouteQuery(),this.unwatchRouteQuery=null},setRouteQueryListener:function(){var t=this;this.unwatchRouteQuery||(this.unwatchRouteQuery=this.$watch("$route.query",function(e,i){t.dataSource.list=[],t.dataSource.size=0,t.dataSource.error="",t.dataSource.fetching=!1,t.extractFromQuery(t.mergeDefaultQuery(e))}))},unsetChangeListener:function(){"function"==typeof this.unwatchConditions&&this.unwatchConditions(),this.unwatchConditions=null,"function"==typeof this.unwatchFilterConds&&this.unwatchFilterConds(),this.unwatchFilterConds=null,"function"==typeof this.unwatchSortConds&&this.unwatchSortConds(),this.unwatchSortConds=null,"function"==typeof this.unwatchPageConds&&this.unwatchPageConds(),this.unwatchPageConds=null},setChangeListener:function(){var t=this;setTimeout(function(){t.unwatchConditions||(t.unwatchConditions=t.$watch("conditions",function(e,i){t.previousConditions=i},{deep:!0})),t.listenConditionChange===!1||t.unwatchFilterConds||(t.unwatchFilterConds=t.$watch("filterConds",function(){t.pageConds&&(t.pageConds.pageIndex=1),t.fetch()},{deep:!0})),t.sortConds&&!t.unwatchSortConds&&(t.unwatchSortConds=t.$watch("sortConds",function(e,i){t.fetch()},{deep:!0})),t.pageConds&&!t.unwatchPageConds&&(t.unwatchPageConds=t.$watch("pageConds",function(e,i){t.fetch()},{deep:!0}))},0)},_initialize:function(){var t=this;this.initializing=!0,this.initialize().then(function(){t.$refs.lookup&&t.$refs.lookup.$on("click",function(){t.pageConds&&(t.pageConds.pageIndex=1),t.fetch()}),t.defaultConditions=Object.assign({},t.conditions),t.disableGlobalQueryCache?t.extractFromQuery(t.mergeDefaultQuery(t.$route.query)):t.extractFromQuery(t.mergeDefaultQuery(t.$store.state.query,t.$route.query)),t.initializing=!1,t.$emit("ready")})},onSortChange:function(t){var e=(t.column,t.prop),i=t.order;this.sortConds.sortField=e,this.sortConds.isAsc=i},mergeDefaultQuery:function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this.defaultConditions),t.unshift({}),Object.assign.apply(Object,t)},mergeLastQuery:function(){},extractFromQuery:function(t){this.pageConds&&(this.pageConds=Object.assign({},this.pageConds,o(this.pageConds,t))),this.queryConds&&(this.queryConds=Object.assign({},this.queryConds,o(this.queryConds,t))),this.comboConds&&(this.comboConds=Object.assign({},this.comboConds,o(this.comboConds,t))),this.sortConds&&(this.sortConds=Object.assign({},this.sortConds,o(this.sortConds,t)))}}}},1151:function(t,e){},1686:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("Modal",{directives:[{name:"model",rawName:"v-model",value:t.show,expression:"show"}],attrs:{id:"positionDetailModal"},domProps:{value:t.show},on:{input:function(e){t.show=e}}},[i("button",{staticClass:"close",attrs:{type:"button"},on:{click:function(e){t.show=!1}}},[i("span",[t._v("×")])]),t._v(" "),i("ModalHeader",[i("b",{staticStyle:{"line-height":"28px"}},[t._v(t._s(t.model.financialContractNo)+"    "+t._s(t.model.financialContractName))]),t._v(" "),t.isEdit?t._e():i("el-button",{staticClass:"edit-button",attrs:{type:"primary"},on:{click:function(e){t.isEdit=!0}}},[t._v("编辑")])]),t._v(" "),i("ModalBody",{attrs:{align:"left"}},[i("div",[i("div",{staticClass:"bd"},[i("el-table",{staticClass:"td-15-padding th-8-15-padding",attrs:{data:t.showDataList,"max-height":"680",stripe:"",border:""}},[i("el-table-column",{attrs:{label:"项目职务"},inlineTemplate:{render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.isEdit&&!t.isEditPostion(t.row.position)?i("div",[i("el-input",{directives:[{name:"model",rawName:"v-model",value:t.row.position,expression:"row.position"}],class:{"error-input":!t.row.position&&(t.row.name||t.row.phone)&&t.isCheck,"conflict-input":t.isConfict(t.row.position)&&t.isCheck},attrs:{size:"small"},domProps:{value:t.row.position},on:{input:function(e){t.row.position=e}}}),t._v(" "),t.isConfict(t.row.position)&&t.isCheck?i("span",{staticStyle:{"font-size":"10px",color:"red",position:"absolute"}},[t._v("项目职务不能重复")]):t._e()]):i("div",[t._v(t._s(t.row.position))]),t._v(" ")])},staticRenderFns:[]}}),t._v(" "),i("el-table-column",{attrs:{label:"姓名"},inlineTemplate:{render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.isEdit?i("div",[i("el-input",{directives:[{name:"model",rawName:"v-model",value:t.row.name,expression:"row.name"}],attrs:{size:"small"},domProps:{value:t.row.name},on:{input:function(e){t.row.name=e}}})]):i("div",[t._v(t._s(t.row.name))]),t._v(" ")])},staticRenderFns:[]}}),t._v(" "),i("el-table-column",{attrs:{label:"联系方式"},inlineTemplate:{render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.isEdit?i("div",[i("el-input",{directives:[{name:"model",rawName:"v-model",value:t.row.phone,expression:"row.phone"}],attrs:{size:"small"},domProps:{value:t.row.phone},on:{input:function(e){t.row.phone=e}}})]):i("div",[t._v(t._s(t.row.phone))]),t._v(" ")])},staticRenderFns:[]}}),t._v(" "),i("el-table-column",{staticClass:"middle",attrs:{label:"系统账号"},inlineTemplate:{render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[!t.row.principalName&&t.isEdit?i("a",{attrs:{href:"#"},on:{click:function(e){e.preventDefault(),t.openPrincipalModal(t.row)}}},[t._v("关联+")]):t._e(),t._v(" "),t.row.principalName&&t.isEdit?i("a",{attrs:{href:"#"},on:{click:function(e){e.preventDefault(),t.openPrincipalModal(t.row)}}},[t._v(t._s(t.row.principalName))]):t._e(),t._v(" "),t.row.principalName&&!t.isEdit?i("a",{attrs:{href:t.ctx+"#/system/user/"+t.row.principalId}},[t._v(t._s(t.row.principalName))]):t._e()])},staticRenderFns:[]}})])]),t._v(" "),t.isEdit?i("div",{staticClass:"create-row"},[i("a",{attrs:{href:"#"},on:{click:function(e){e.preventDefault(),t.handleCreate(e)}}},[t._v("新增+")])]):t._e()])]),t._v(" "),t.isEdit?i("ModalFooter",[i("el-button",{attrs:{size:"small"},on:{click:t.handleCancel}},[t._v("取消")]),t._v(" "),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.saveChange}},[t._v("保存")])]):t._e()]),t._v(" "),i("PrincipalModal",{directives:[{name:"model",rawName:"v-model",value:t.principalModal.visible,expression:"principalModal.visible"}],attrs:{model:t.principalModal.model,principalShowList:t.principalShowList},domProps:{value:t.principalModal.visible},on:{submit:t.handlePrincipalSubmit,input:function(e){t.principalModal.visible=e}}})])},staticRenderFns:[]}},1567:function(t,e,i){var n,a;i(1151),n=i(687);var o=i(1686);a=n=n||{},"object"!=typeof n.default&&"function"!=typeof n.default||(a=n=n.default),"function"==typeof a&&(a=a.options),a.render=o.render,a.staticRenderFns=o.staticRenderFns,t.exports=n},687:function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=i(1),o=i(2),s=n(o),r=i(92);e.default={components:{PrincipalModal:i(1569)},props:{value:Boolean,model:{type:Object,default:function(){}},principalShowList:{type:Array,default:function(){return[]}}},data:function(){return{show:this.value,showDataList:(0,r.cloneDeep)(this.model.list),isEdit:!1,isCheck:!1,principalModal:{visible:!1,model:{}}}},watch:{value:function(t){this.show=t},show:function(t){this.isEdit=!1,this.$emit("input",t)},"model.list":{deep:!0,handler:function(t){t.length?this.showDataList=(0,r.cloneDeep)(t):this.showDataList=["五维负责人","云信投运对接人","贷前运营","贷前技术","云信信托经理","云信财务"].map(function(t){return{position:t,name:"",phone:"",principalName:"",principalId:""}})}}},methods:{isConfict:function(t){var e=this.showDataList.map(function(t){return t.position}),i=e.filter(function(e){return e===t&&""!==t}).length;return i>1},isEditPostion:function(t){return["五维负责人","云信投运对接人","贷前运营","贷前技术","云信信托经理","云信财务"].includes(t)},handleCreate:function(){this.isCheck=!1,this.showDataList.push({position:"",name:"",phone:"",principalName:"",principalId:""})},openPrincipalModal:function(t){this.principalModal.visible=!0,this.principalModal.model=t},handlePrincipalSubmit:function(t,e){this.showDataList.filter(function(i){i.position===e.position&&(i.principalId=t.principalId,i.principalName=t.name)})},saveChange:function(){var t=this;setTimeout(function(){t.isCheck=!0},0);var e=function(e){var i=!1;return(!e.position&&(e.name||e.phone)||t.isConfict(e.position))&&(i=!0),i},i=this.showDataList.some(function(t){return e(t)});i||(this.showDataList=this.showDataList.filter(function(t){return""!==t.position}),(0,a.ajaxPromise)({url:"/position/edit-position",type:"post",data:{financialContractUuid:this.model.financialContractUuid,positionDetailList:JSON.stringify(this.showDataList)}}).then(function(e){s.default.once("close",function(){t.$emit("submit",t.model.financialContractUuid)}),s.default.open("保存成功"),t.isEdit=!1}).catch(function(t){s.default.open(t)}))},handleCancel:function(){this.model.list.length?this.showDataList=(0,r.cloneDeep)(this.model.list):this.showDataList=["五维负责人","云信投运对接人","贷前运营","贷前技术","云信信托经理","云信财务"].map(function(t){return{position:t,name:"",phone:"",principalName:"",principalId:""}}),this.isEdit=!1}}}},1854:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"content"},[i("div",{staticClass:"scroller"},[i("div",{staticClass:"query-area"},[i("el-form",{staticClass:"sdf-form sdf-query-form",attrs:{inline:!0}},[i("el-form-item",[i("el-select",{directives:[{name:"model",rawName:"v-model",value:t.queryConds.appId,expression:"queryConds.appId"}],attrs:{size:"small",clearable:"",placeholder:"资产方"},domProps:{value:t.queryConds.appId},on:{input:function(e){t.queryConds.appId=e}}},t._l(t.appList,function(t){return i("el-option",{attrs:{label:t.name,value:t.id}})}))]),t._v(" "),i("el-form-item",[i("span",{staticClass:"item vertical-line"})]),t._v(" "),i("el-form-item",[i("ComboQueryBox",{directives:[{name:"model",rawName:"v-model",value:t.comboConds,expression:"comboConds"}],domProps:{value:t.comboConds},on:{input:function(e){t.comboConds=e}}},[i("el-option",{attrs:{value:"financialContractNo",label:t.$utils.locale("financialContract.no")}}),t._v(" "),i("el-option",{attrs:{value:"financialContractName",label:t.$utils.locale("financialContract.name")}}),t._v(" "),i("el-option",{attrs:{value:"positionName",label:"项目职务"}})])]),t._v(" "),i("el-form-item",[i("el-button",{ref:"lookup",attrs:{size:"small",type:"primary"}},[t._v("查询")])])])]),t._v(" "),i("div",{staticClass:"table-area"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.dataSource.fetching,expression:"dataSource.fetching"}],staticClass:"no-table-bottom-border",attrs:{stripe:"",data:t.dataSource.list}},[i("el-table-column",{attrs:{label:t.$utils.locale("financialContract.no"),prop:"financialContractNo"}}),t._v(" "),i("el-table-column",{attrs:{label:t.$utils.locale("financialContract.name"),prop:"financialContractName"}}),t._v(" "),i("el-table-column",{attrs:{label:"资产方",prop:"appName"}}),t._v(" "),i("el-table-column",{attrs:{label:"五维负责人",prop:"positionNameOne"}}),t._v(" "),i("el-table-column",{attrs:{label:"云信投运对接人",prop:"positionNameTwo"}}),t._v(" "),i("el-table-column",{attrs:{label:"贷前运营",prop:"positionNameThree"}}),t._v(" "),i("el-table-column",{attrs:{label:"贷前技术",prop:"positionNameFour"}}),t._v(" "),i("el-table-column",{attrs:{label:"云信信托经理",prop:"positionNameFive"}}),t._v(" "),i("el-table-column",{attrs:{label:"云信财务",prop:"positionNameSix"}}),t._v(" "),i("el-table-column",{attrs:{label:"操作"},inlineTemplate:{render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",{staticStyle:{color:"#436ba7",cursor:"pointer"},on:{click:function(e){e.preventDefault(),t.getDetailData(t.row.financialContractUuid)}}},[t._v("详情")])},staticRenderFns:[]}})])])]),t._v(" "),i("div",{staticClass:"operations"},[i("div",{staticClass:"pull-right"},[i("PageControl",{directives:[{name:"model",rawName:"v-model",value:t.pageConds.pageIndex,expression:"pageConds.pageIndex"}],attrs:{size:t.dataSource.size,"per-page-record-number":t.pageConds.perPageRecordNumber},domProps:{value:t.pageConds.pageIndex},on:{input:function(e){t.pageConds.pageIndex=e}}})])]),t._v(" "),i("DetailModal",{directives:[{name:"model",rawName:"v-model",value:t.detailModal.visible,expression:"detailModal.visible"}],attrs:{principalShowList:t.principalShowList,model:t.detailModal.model},domProps:{value:t.detailModal.visible},on:{submit:t.handleSubmit,input:function(e){t.detailModal.visible=e}}})])},staticRenderFns:[]}},688:function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=i(4),o=n(a),s=i(5),r=n(s),l=i(1),c=i(2),u=n(c);e.default={mixins:[o.default,r.default],components:{ComboQueryBox:i(6),DetailModal:i(1567)},data:function(){return{action:"/position/query",pageConds:{perPageRecordNumber:12,pageIndex:1},queryConds:{appId:""},comboConds:{financialContractNo:"",financialContractName:"",positionName:""},appList:[],principalShowList:[],detailModal:{visible:!1,model:{financialContractNo:"",financialContractName:"",financialContractUuid:"",list:[]}}}},activated:function(){this.getOptions(),this.getPrincipalList()},methods:{getOptions:function(){var t=this;return(0,l.ajaxPromise)({url:"/financialContract/optionData"}).then(function(e){t.financialContractTypeList=e.financialContractTypeList||[],t.appList=e.appList||[]}).catch(function(t){u.default.open(t)})},getPrincipalList:function(){var t=this;(0,l.ajaxPromise)({url:"/position/get-principal"}).then(function(e){t.principalShowList=e.principalShowList||[]}).catch(function(t){u.default.open(t)})},getDetailData:function(t){var e=this;(0,l.ajaxPromise)({url:"/position/detail/data",data:{financialContractUuid:t}}).then(function(i){e.detailModal.model.financialContractNo=i.financialContractNo,e.detailModal.model.financialContractName=i.financialContractName,e.detailModal.model.financialContractUuid=t,e.detailModal.model.list=i.list||[],e.detailModal.visible=!0}).catch(function(t){u.default.open(t)})},handleSubmit:function(t){this.getDetailData(t)}}}},1568:function(t,e,i){var n,a;n=i(688);var o=i(1854);a=n=n||{},"object"!=typeof n.default&&"function"!=typeof n.default||(a=n=n.default),"function"==typeof a&&(a=a.options),a.render=o.render,a.staticRenderFns=o.staticRenderFns,t.exports=n},689:function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=(i(1),i(2));n(a);e.default={props:{value:Boolean,model:{type:Object,default:function(){return{}}},principalShowList:{type:Array,default:function(){return[]}}},watch:{value:function(t){var e=this;this.show=t,t&&this.principalShowList.forEach(function(t){t.principalId===e.model.principalId&&e.$nextTick(function(){e.$refs.selectionTable.toggleRowSelection(t,!0)})})},show:function(t){this.$emit("input",t),this.$refs.selectionTable.clearSelection()}},data:function(){return{show:this.value,selectPrincipal:""}},methods:{handleSelect:function(t,e){this.$refs.selectionTable.clearSelection(),t.length?(this.$refs.selectionTable.toggleRowSelection(e),this.selectPrincipal=e):this.selectPrincipal={principalId:"",name:"",realName:""}},save:function(){this.$emit("submit",this.selectPrincipal,this.model),this.show=!1}}}},1191:function(t,e){},1569:function(t,e,i){var n,a;i(1191),n=i(689);var o=i(1755);a=n=n||{},"object"!=typeof n.default&&"function"!=typeof n.default||(a=n=n.default),"function"==typeof a&&(a=a.options),a.render=o.render,a.staticRenderFns=o.staticRenderFns,t.exports=n},1755:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Modal",{directives:[{name:"model",rawName:"v-model",value:t.show,expression:"show"}],attrs:{id:"principalModal"},domProps:{value:t.show},on:{input:function(e){t.show=e}}},[i("ModalBody",{attrs:{align:"left"}},[i("el-table",{ref:"selectionTable",staticClass:"td-15-padding th-8-15-padding principal-table",staticStyle:{width:"100%"},attrs:{data:t.principalShowList,"max-height":"480",stripe:"",border:""},on:{select:t.handleSelect}},[i("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),i("el-table-column",{attrs:{prop:"name",label:"用户名"}}),t._v(" "),i("el-table-column",{attrs:{prop:"realName",label:"持有者"}})])]),t._v(" "),i("ModalFooter",[i("el-button",{on:{click:function(e){t.show=!1}}},[t._v("取消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("保存")])])])},staticRenderFns:[]}},6:function(t,e,i){var n,a;i(23),n=i(22);var o=i(24);a=n=n||{},"object"!=typeof n.default&&"function"!=typeof n.default||(a=n=n.default),"function"==typeof a&&(a=a.options),a.render=o.render,a.staticRenderFns=o.staticRenderFns,t.exports=n},22:function(t,e){"use strict";function i(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){var e,i,n="";Object.keys(t).some(function(n){var a=t[n];if(null!=a&&""!=a)return e=n,i=a,!0});return{activeKey:e,activeValue:i,iconClose:n}};e.default={props:{value:{required:!0,type:Object}},data:function(){return n(this.value)},watch:{activeKey:function(t){this.activeValue&&this.$emit("input",i({},this.activeKey,this.activeValue))},activeValue:function(t){this.activeKey&&this.$emit("input",i({},this.activeKey,this.activeValue))},value:function(t){var e=n(t),i=e.activeKey,a=e.activeValue;i&&(this.activeKey=i),this.activeValue=a}},methods:{handleChange:function(t){this.iconClose=t?"close":"",this.activeValue=t}}}},24:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-input",{staticClass:"combo-query-box",attrs:{value:t.activeValue,size:"small",icon:t.iconClose,placeholder:"请输入内容"},on:{change:t.handleChange,click:function(e){t.activeValue=""}}},[i("el-select",{directives:[{name:"model",rawName:"v-model",value:t.activeKey,expression:"activeKey"}],staticClass:"short",attrs:{placeholder:"请选择"},domProps:{value:t.activeKey},on:{input:function(e){t.activeKey=e}},slot:"prepend"},[t._t("default")],!0)])},staticRenderFns:[]}},23:function(t,e){}});