define(function(require,exports,module){var i=require("component/popupTip"),t=require("component/dialogView"),e=require("baseView/baseFormView").FormDialogView,a=e.extend({template:_.template($("#cancelDialogTmpl").html()),className:"modal fade form-modal small-form-modal",initialize:function(){a.__super__.initialize.apply(this,arguments),this.defineValidator()},defineValidator:function(){this.validator=this.$("form").validate({rules:{comment:{required:!0,maxlength:50}},messages:{comment:{maxlength:"备注信息不超过50字"}}})},validate:function(){return this.validator.form()},submitHandler:function(){this.validate()&&this.model.cancel(this.extractDomData())}}),n=Backbone.Model.extend({actions:{activite:"./guarantee-active",cancel:"./guarantee-lapse"},activite:function(){var i=this.get("orderId");if(i){var t=this,e={url:this.actions.activite,dataType:"json",type:"post"};e.success=function(i){t.trigger("activite",i)},$.ajax(e)}},cancel:function(i){var t=this.get("orderId");if(t){var e=this,a={url:this.actions.cancel,dataType:"json",type:"post",data:i};a.success=function(i){e.trigger("cancel",i)},$.ajax(a)}}}),o=Backbone.View.extend({el:".content",events:{"click #activite":"onClickActivite","click #cancel":"onClickCancel"},initialize:function(i){var e={orderId:i};this.model=new n(e),this.confirm=new t,this.listenTo(this.model,"activite",this.onAjaxCallback),this.listenTo(this.model,"cancel",this.onAjaxCallback),this.listenTo(this.confirm,"goahead",function(i){i.call(this.model),this.confirm.hide()})},delayReload:function(i){setTimeout(function(){location.reload()},i||1e3)},onAjaxCallback:function(t){0==t.code?this.delayReload():i.show(t.message)},onClickActivite:function(){this.confirm.show("确认激活？",this.model.activite)},onClickCancel:function(){var i=new a({model:this.model});i.show()}});module.exports=o});